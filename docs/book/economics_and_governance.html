<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Economics and Governance - The-Block Documentation</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The-Block Documentation</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="economics-and-governance"><a class="header" href="#economics-and-governance">Economics and Governance</a></h1>
<blockquote>
<p><strong>Plain-Language Overview</strong></p>
<p><strong>BLOCK is the single token.</strong> Everything in The Block settles in BLOCK — payments, rewards, fees, treasury disbursements. There's no second currency. Some internal labels (for example <code>coin_c</code>/<code>coin_i</code>) remain for compatibility, but they are BLOCK-denominated buckets, not separate tokens.</p>
<p><strong>How BLOCK moves around:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Flow</th><th>What Happens</th></tr></thead><tbody>
<tr><td><strong>Mining</strong></td><td>New BLOCK is minted in each block's "coinbase" (the first transaction)</td></tr>
<tr><td><strong>Subsidies</strong></td><td>Part of that coinbase goes to storage/compute/bandwidth providers (<code>STORAGE_SUB</code>, <code>READ_SUB</code>, <code>COMPUTE_SUB</code>)</td></tr>
<tr><td><strong>Fees</strong></td><td>Users pay BLOCK for transactions; fees are split between validators and treasury</td></tr>
<tr><td><strong>Rebates</strong></td><td>Users may receive "rebates" — ledger entries that reduce future costs (not separate tokens)</td></tr>
<tr><td><strong>Treasury</strong></td><td>Community fund; disbursements require governance votes</td></tr>
</tbody></table>
</div>
<p><strong>Governance in a nutshell:</strong> BLOCK holders vote on proposals. Proposals can change parameters (like fee floors), allocate treasury funds, or upgrade the network. There's a timelock between approval and activation to allow for rollbacks if something goes wrong.</p>
</blockquote>
<p>Everything settles in BLOCK. Consumer workloads, industrial compute/storage, and governance treasury actions all share the same ledger so explorers/CLI/telemetry never disagree.</p>
<h2 id="block-supply-and-sub-ledgers"><a class="header" href="#block-supply-and-sub-ledgers">BLOCK Supply and Sub-Ledgers</a></h2>
<ul>
<li>Coinbases embed <code>STORAGE_SUB</code>, <code>READ_SUB</code>, and <code>COMPUTE_SUB</code> fields (see <code>node/src/blockchain/block_binary.rs</code>). Each bucket mints BLOCK but is accounted separately for policy analysis.</li>
<li><code>coin_c</code>/<code>coin_i</code> are legacy ledger labels for BLOCK-denominated buckets; they do not represent a second token. Lane routing happens at transaction submission, while subsidy accounting stays unified in BLOCK.</li>
<li>Industrial workload gauges (<code>industrial_backlog</code>, <code>industrial_utilization</code>) feed the subsidy allocator (<code>node/src/economics/subsidy_allocator.rs</code>) and replay-derived market metrics (<code>node/src/economics/replay.rs</code>).</li>
<li>Personal rebates are ledger entries only. They auto-apply to the submitter’s own write traffic before dipping into transferable BLOCK and never circulate.</li>
</ul>
<h2 id="network-driven-block-issuance"><a class="header" href="#network-driven-block-issuance">Network-Driven BLOCK Issuance</a></h2>
<blockquote>
<p><strong>Plain English:</strong> Instead of targeting a fixed inflation rate, the protocol mints new BLOCK based on how busy (and how decentralized) the network actually is, while respecting the 40 M cap.</p>
</blockquote>
<p>The canonical issuance controller lives in <code>node/src/economics/network_issuance.rs</code> and is mirrored in telemetry/CLI/explorer. Every block reward is derived from the same four-factor formula:</p>
<p>[
\text{reward} = \text{base} \times \text{activity} \times \text{decentralization} \times \text{supply_decay}
]</p>
<ul>
<li><strong>Base reward</strong> — distribute 90 % of the 40 M cap evenly across the expected number of blocks (<code>max_supply_block</code>, <code>expected_total_blocks</code>). Using 90 % leaves room for tail emission.</li>
<li><strong>Activity multiplier</strong> — geometric mean of transaction-count ratio, transaction-volume ratio, and <code>(1 + avg_market_utilization)</code>; each input is smoothed via adaptive baselines (EMA with governance-set clamps) so a growing network naturally earns more while a quiet network decays back toward 1.0 ×. Bounds: <code>[activity_multiplier_min, activity_multiplier_max]</code>.</li>
<li><strong>Decentralization factor</strong> — <code>sqrt(unique_miners / baseline_miners)</code> with the same EMA/bounds treatment. More independent miners increase rewards; a shrinking set dampens them. Bounds: <code>[decentralization_multiplier_min, decentralization_multiplier_max]</code>.</li>
<li><strong>Supply decay</strong> — linear decay based on remaining supply <code>(MAX_SUPPLY_BLOCK - emission) / MAX_SUPPLY_BLOCK</code>; prevents the cap from being exceeded and emulates a halving-style tail.</li>
</ul>
<p>All state for this controller (EMA baselines, clamp bounds, alpha values) is stored in the governance params struct <code>NetworkIssuanceParams</code> and exposed via telemetry so replay stays deterministic.</p>
<h3 id="telemetry-driven-gating"><a class="header" href="#telemetry-driven-gating">Telemetry-driven gating</a></h3>
<p>Every epoch <code>node/src/lib.rs</code> increments the on-chain counters <code>economics_epoch_tx_count</code>,
<code>economics_epoch_tx_volume_block</code>, and <code>economics_epoch_treasury_inflow_block</code> as transactions hit the
chain. Those counters, along with <code>recent_miners</code> and the stored circulations, feed <code>NetworkIssuanceController</code>
inside <code>execute_epoch_economics()</code>, which writes the next <code>economics_block_reward_per_block</code>.
Telemetry mirrors the same values (<code>ECONOMICS_EPOCH_*</code> gauges plus <code>ECONOMICS_BLOCK_REWARD_PER_BLOCK</code>)
so Launch Governor's autopilot can verify throughput, volume, and treasury inflow before flipping the
testnet → mainnet gate. Each node persists the latest base reward in <code>ChainDisk</code> so restarts follow the same
control decisions and progress toward the live network with no manual tuning.</p>
<h3 id="legacy-inflation-controller-compatibility-only"><a class="header" href="#legacy-inflation-controller-compatibility-only">Legacy Inflation Controller (compatibility only)</a></h3>
<p>The pre-BLOCK codebase exposed knobs such as <code>inflation_target_bps</code>, <code>inflation_controller_gain</code>, <code>min_annual_issuance_block</code>, and <code>max_annual_issuance_block</code>. These still exist for backward compatibility with tooling, but they are no longer the primary monetary policy. Any proposal that touches those fields must explicitly justify how it keeps the network-driven issuance formula aligned; otherwise the docs and <code>NetworkIssuanceController</code> are treated as the source of truth.</p>
<h2 id="energy-market-economics"><a class="header" href="#energy-market-economics">Energy Market Economics</a></h2>
<ul>
<li><strong>Single-token model</strong> — Energy payouts settle in BLOCK just like storage/compute. Credits (<code>EnergyCredit</code>) and receipts (<code>EnergyReceipt</code>) are internal ledger objects stored in <code>SimpleDb::open_named(names::ENERGY_MARKET, …)</code>; settlement burns meter credits, decrements provider capacity, and records <code>EnergyReceipt { buyer, seller, kwh_delivered, price_paid, treasury_fee, slash_applied }</code>.</li>
<li><strong>Treasury integration</strong> — <code>node::energy::settle_energy_delivery</code> forwards <code>treasury_fee + slash_applied</code> to <code>NODE_GOV_STORE.record_treasury_accrual</code>, so explorer/CLI treasury views capture energy fees without extra plumbing. Governance proposals can earmark these accruals like any other treasury inflow.</li>
<li><strong>Governance parameters</strong> — <code>energy_min_stake</code>, <code>energy_oracle_timeout_blocks</code>, and <code>energy_slashing_rate_bps</code> live in the shared <code>governance</code> crate (<code>ParamKey::EnergyMinStake</code>, etc.). Proposals use the same <code>ParamSpec</code> flow as other knobs; once activated, <code>node::energy::set_governance_params</code> updates the runtime config and snapshots the energy sled DB. Outstanding work adds new payloads (batch vs real-time settlement, dependency graph validation) tracked in <code>docs/architecture.md#energy-governance-and-rpc-next-tasks</code>.</li>
<li><strong>Oracle economics</strong> — Meter readings produce <code>EnergyCredit</code> entries keyed by the reading hash (BLAKE3 over provider, meter, readings, timestamp, signature). Credits expire after <code>energy_oracle_timeout_blocks</code>; stale readings cannot be settled and must be re-issued. <code>energy.submit_reading</code> RPC will soon enforce signature validation and multi-reading attestations, with slashing telemetry + dispute RPCs covering bad actors.</li>
<li><strong>CLI/RPC visibility</strong> — <code>contract-cli energy market --verbose</code> and <code>energy.market_state</code> expose provider capacity, price, stake, outstanding credits, and receipts so explorers can mirror the same tables. Upcoming explorer work adds energy provider tables, receipt timelines, and slash summaries (see <code>AGENTS.md</code> tasks).</li>
<li><strong>Dispute flow</strong> — Until dedicated dispute RPCs land, governance proposals (e.g., temporarily raising <code>energy_slashing_rate_bps</code> for a provider, pausing settlement) act as the economic kill switch. Once the dispute endpoints ship they will create ledger anchors referencing disputed meter hashes while preserving BLOCK accounting invariants.</li>
</ul>
<h2 id="multipliers-and-emissions"><a class="header" href="#multipliers-and-emissions">Multipliers and Emissions</a></h2>
<blockquote>
<p><strong>Plain English:</strong> The network automatically adjusts how much BLOCK goes to different services based on usage. If storage usage is low, storage rewards increase to attract providers. If usage is high, rewards dampen to avoid overpaying.</p>
<p><strong>Symbol guide:</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Symbol</th><th>Meaning</th></tr></thead><tbody>
<tr><td><code>phi_x</code></td><td>Policy knob for this service (set by governance)</td></tr>
<tr><td><code>I_target</code></td><td>Target BLOCK issuance per year</td></tr>
<tr><td><code>S</code></td><td>Share allocated to this service type</td></tr>
<tr><td><code>U_x</code></td><td>Real usage this epoch</td></tr>
<tr><td><code>epoch_secs</code></td><td>How long an epoch lasts</td></tr>
</tbody></table>
</div></blockquote>
<ul>
<li>Per-epoch utilisation <code>U_x</code> feeds the "one dial" multiplier:
[
\text{multiplier}<em>x = \frac{\phi_x I</em>{\text{target}} S / 365}{U_x / \text{epoch_secs}}
]
Adjustments clamp to ±15 % to prevent thrash. Near-zero utilisation doubles the multiplier to keep incentives alive; governance can override via <code>kill_switch_subsidy_reduction</code>.</li>
<li>Miner base reward follows the logistic curve implemented in <code>node/src/consensus/leader.rs</code>:
[
R_0(N) = \frac{R_{\max}}{1+e^{\xi (N-N^\star)}}
]
with hysteresis (ΔN ≈ √N*) that damps flash joins/leaves.</li>
<li>Governance, ledger, CLI, explorer, and metrics aggregator all pull multiplier history through the shared <code>governance</code> crate to avoid drift.</li>
</ul>
<blockquote>
<p><strong>Implementation note:</strong> The subsidy allocator, multiplier controller, and ad/tariff drift controllers run every epoch today. Provider margin inputs for storage/compute/ad are still being wired (see <code>AGENTS.md §15</code>), so telemetry may show placeholders until those metrics land. The formulas above remain authoritative and must be kept in sync with <code>node/src/economics/**/*.rs</code>.</p>
</blockquote>
<h2 id="fee-lanes-and-rebates"><a class="header" href="#fee-lanes-and-rebates">Fee Lanes and Rebates</a></h2>
<blockquote>
<p><strong>Plain English:</strong> Fee lanes are like different queues at the post office. Each lane has its own rules and pricing.</p>
<div class="table-wrapper"><table><thead><tr><th>Lane</th><th>Who Uses It</th><th>How Pricing Works</th></tr></thead><tbody>
<tr><td><strong>Consumer</strong></td><td>Regular wallet users</td><td>Base fee + tip; auto-adjusts based on mempool fullness</td></tr>
<tr><td><strong>Industrial</strong></td><td>Storage/compute providers</td><td>Higher base, but subsidized by block rewards</td></tr>
<tr><td><strong>Priority</strong></td><td>Anyone who needs fast inclusion</td><td>Pay more, get included sooner</td></tr>
<tr><td><strong>Treasury</strong></td><td>Governance disbursements</td><td>Fixed rates set by governance</td></tr>
</tbody></table>
</div>
<p><strong>Rebates</strong> are ledger entries that reduce your future costs. If you overpaid or qualify for a promotion, you get a rebate that auto-applies to your next transactions. Rebates are NOT tokens — you can't send them to someone else.</p>
</blockquote>
<ul>
<li><code>node/src/fee</code> defines the lane taxonomy (consumer, industrial, priority, treasury). <code>node/src/fees</code> implements QoS eviction and rebate books shared with RPC.</li>
<li>Lane-aware mempool enforcement sits in <code>node/src/mempool</code> (see <code>docs/architecture.md#fee-lanes-and-rebates</code>). Each block nudges the base fee toward a fullness target while telemetry exposes <code>fee_floor_current</code> plus per‑lane <code>fee_floor_warning_total</code> / <code>fee_floor_override_total</code>.</li>
<li>Rebates are persisted ledger entries exposed via RPC (<code>node/src/rpc/fees.rs</code>) and CLI (<code>cli/src/fee_estimator.rs</code>).</li>
</ul>
<h2 id="lane-congestion-pricing"><a class="header" href="#lane-congestion-pricing">Lane Congestion Pricing</a></h2>
<blockquote>
<p><strong>Plain English:</strong> The lane pricing engine treats each lane as its own queue with feedback control. Pricing rises smoothly as utilisation approaches 100 %, and a PI controller dampens oscillations so users see predictable fees.</p>
</blockquote>
<ul>
<li><strong>Queueing model (M/M/1):</strong> Utilisation <code>ρ = λ / μ</code> per lane, clamped to <code>(0, 1)</code>. Congestion multiplier:
[
C(ρ) = 1 + k \left(\frac{ρ}{1-ρ}\right)^n
]
where <code>k</code> and <code>n</code> are lane-specific sensitivity parameters.</li>
<li><strong>PI controllers:</strong> Per-lane proportional–integral loops hold utilisation near targets:
[
A_{t+1} = A_t \cdot \left(1 + K_p e_t + K_i \sum e_t\right),\quad e_t = ρ_{\text{target}} - ρ_{\text{actual}}
]
with anti-windup caps to prevent runaway adjustments.</li>
<li><strong>Market demand multiplier (industrial):</strong> Market signals feed a bounded multiplier:
[
M(D) = 1 + α \cdot \frac{e^{βD}-1}{e^{β}-1},\quad D \in [0, 1]
]
giving smooth growth from <code>1.0</code> to <code>1.0 + α</code>.</li>
<li><strong>Cross-lane arbitrage prevention:</strong> Industrial fees floor against consumer fees with a premium <code>δ</code>, and congestion signals are lane-local so bursts in one lane do not drag the other.</li>
<li><strong>Composite fees:</strong>
<ul>
<li>Consumer: <code>F_c = B_c · C_c(ρ_c) · A_c(t)</code></li>
<li>Industrial: <code>F_i = max(B_i · C_i(ρ_i) · M_i(D), F_c · (1 + δ))</code></li>
</ul>
</li>
<li><strong>Telemetry and control loop:</strong> <code>node/src/fees/lane_pricing.rs</code> runs the loop each block using utilisation snapshots from <code>node/src/fees/congestion.rs</code> and demand signals from <code>node/src/fees/market_signals.rs</code>. Gauges expose per-lane utilisation, congestion multipliers, PI adjustments, and applied premiums for dashboards.</li>
<li><strong>Governance parameters (defaults live in <code>governance/src/params.rs</code>):</strong></li>
</ul>
<div class="table-wrapper"><table><thead><tr><th>Parameter (see <code>node/src/governance/params.rs</code>)</th><th>Default</th><th>Meaning</th></tr></thead><tbody>
<tr><td><code>lane_consumer_capacity</code></td><td>1000</td><td>Nominal consumer throughput used for utilisation <code>ρ</code></td></tr>
<tr><td><code>lane_industrial_capacity</code></td><td>500</td><td>Nominal industrial throughput used for utilisation <code>ρ</code></td></tr>
<tr><td><code>lane_consumer_congestion_sensitivity</code></td><td>300</td><td><code>k = 3.0</code> congestion sensitivity (value / 100)</td></tr>
<tr><td><code>lane_industrial_congestion_sensitivity</code></td><td>500</td><td><code>k = 5.0</code> congestion sensitivity (value / 100)</td></tr>
<tr><td><code>lane_industrial_min_premium_percent</code></td><td>50</td><td>Minimum industrial premium over consumer (percent)</td></tr>
<tr><td><code>lane_target_utilization_percent</code></td><td>70</td><td>PI target utilisation (percent)</td></tr>
<tr><td><code>lane_market_signal_half_life</code></td><td>50</td><td>EMA half-life for demand signal (blocks)</td></tr>
<tr><td><code>lane_market_demand_max_multiplier_percent</code></td><td>300</td><td>Max demand multiplier (percent; 300 = +3.0)</td></tr>
<tr><td><code>lane_market_demand_sensitivity_percent</code></td><td>200</td><td>Demand sensitivity (percent; 200 = 2.0)</td></tr>
<tr><td><code>lane_pi_proportional_gain_percent</code></td><td>10</td><td>PI Kp (percent; 10 = 0.1)</td></tr>
<tr><td><code>lane_pi_integral_gain_percent</code></td><td>1</td><td>PI Ki (percent; 1 = 0.01)</td></tr>
</tbody></table>
</div>
<h2 id="service-badges-and-citizenship"><a class="header" href="#service-badges-and-citizenship">Service Badges and Citizenship</a></h2>
<ul>
<li>Operators earn service badges when uptime/latency stay within governance thresholds. <code>node/src/service_badge.rs</code> calculates eligibility; telemetry publishes <code>BADGE_ISSUED_TOTAL</code>, <code>COMPUTE_PROVIDER_UPTIME</code>, etc.</li>
<li>Badges gate governance votes (Operators + Builders houses) and feed range-boost multipliers plus ANN mesh prioritisation.</li>
</ul>
<h2 id="treasury-and-disbursements"><a class="header" href="#treasury-and-disbursements">Treasury and Disbursements</a></h2>
<blockquote>
<p><strong>Plain English:</strong> The treasury is the community fund. Moving BLOCK out of it requires a governance vote. Here's the timeline:</p>
<pre><code>┌─────────┐    ┌─────────┐    ┌─────────┐    ┌────────────┐    ┌──────────┐    ┌───────────┐
│  DRAFT  │───▶│ VOTING  │───▶│ QUEUED  │───▶│ TIMELOCKED │───▶│ EXECUTED │───▶│ FINALIZED │
└─────────┘    └─────────┘    └─────────┘    └────────────┘    └──────────┘    └───────────┘
     │                                              │                                │
     │                                              │      ┌────────────┐            │
     └──────────────────────────────────────────────┴─────▶│ ROLLED BACK│◀───────────┘
                                                           └────────────┘
</code></pre>
<ul>
<li><strong>Draft</strong>: Someone writes a JSON payload describing where BLOCK should go</li>
<li><strong>Voting</strong>: Bicameral vote (Operators + Builders houses)</li>
<li><strong>Queued</strong>: Passed the vote, waiting for activation</li>
<li><strong>Timelocked</strong>: Waiting period before execution (allows for emergencies)</li>
<li><strong>Executed</strong>: BLOCK actually moves</li>
<li><strong>Finalized</strong>: Done, recorded in ledger</li>
<li><strong>Rolled Back</strong>: Something went wrong; compensation entry created</li>
</ul>
</blockquote>
<ul>
<li>Governance proposals now carry explicit treasury-disbursement payloads in addition to param updates. Each disbursement advances through the canonical state machine: <strong>draft → voting → queued → timelocked → executed → finalized/rolled-back</strong>. Drafts are local JSON payloads (stored under <code>examples/governance/</code>) validated with <code>foundation_serialization</code> schemas before the proposer signs and submits. Voting/timelock rules piggyback on the bicameral governance machinery (see <code>governance/src/bicameral.rs</code>), so disbursements inherit quorum, snapshot, and activation semantics.</li>
<li>Once a disbursement proposal passes, <code>GovStore</code> persists the queued entry in sled and snapshots the activation epoch + prior rollbacks to <code>provenance.json</code> using first-party encoding (Option A from the task brief). The rollback window remains <strong>block-height bounded</strong> via <code>governance::store::ROLLBACK_WINDOW_EPOCHS</code>, guaranteeing deterministic replay on both x86_64 and AArch64.</li>
<li>Executions emit BLOCK receipts inside the consolidated ledger—no new token types—and every transition (queued, timelocked, executed, rollback) records a ledger journal entry so the explorer and CLI timelines never diverge. Rollbacks simply mark the disbursement as <code>RolledBack { rolled_back_at, reason }</code> and append a compensating ledger entry; finalized executions capture the <code>tx_hash</code>, execution height, and attested receipt bundle.</li>
<li>Metrics wiring tracks both balances and pipeline health: <code>treasury_balance</code>, <code>treasury_disbursement_backlog</code>, and <code>governance_disbursements_total{status}</code>. The metrics aggregator exposes <code>/treasury/summary</code> and <code>/governance/disbursements</code> so dashboards can chart backlog age, quorum wait time, and execution throughput alongside existing treasury gauges. Explorer timelines render the same data (proposal metadata, vote outcomes, timelock window, execution tx, affected accounts, receipts, and rollback annotations).</li>
<li><strong>Implementation checklist (AGENTS.md §15.A)</strong> — The governance crate, CLI, explorer, and telemetry stack must:
<ol>
<li>Extend DAG schemas with multi-stage approvals and attested release bundles (<code>governance/</code>, <code>node/src/governance</code>, <code>cli/src/governance</code>, explorer dashboards).</li>
<li>Emit <code>/wrappers</code> metadata whenever treasury diffs occur so operators can diff governance state without scraping sled stores.</li>
<li>Add deterministic replay tests (ledger + <code>node/tests/</code>) proving disbursement streaming/rollback stays byte-identical across CPU architectures and <code>scripts/fuzz_coverage.sh</code> runs cover the updated code paths.</li>
<li>Update <code>docs/operations.md</code>, <code>docs/apis_and_tooling.md</code>, and Grafana timelines with “stuck treasury” runbooks, CLI introspection commands, and badge/fee-floor delta overlays.</li>
</ol>
</li>
</ul>
<h2 id="proposal-lifecycle"><a class="header" href="#proposal-lifecycle">Proposal Lifecycle</a></h2>
<ol>
<li>Snapshot of eligible voters occurs on proposal creation (bicameral: Operators + Builders).</li>
<li>Secret ballots + timelocks enforced by <code>governance/src/bicameral.rs</code>.</li>
<li>Parameter changes apply next epoch; upgrades require supermajority plus rollback windows.</li>
<li>Emergency catalog/app-layer overrides auto-expire and must be fully logged.</li>
</ol>
<h2 id="governance-parameters"><a class="header" href="#governance-parameters">Governance Parameters</a></h2>
<ul>
<li><code>governance/src/params.rs</code> exposes typed knobs for fee floors, multipliers, SLA slashing, telemetry sampling, mesh toggles, AI diagnostics, etc.</li>
<li>Every integration (node, CLI, explorer, metrics aggregator) uses the same crate so policy proofs line up with on-chain values.</li>
<li>Historical policy snapshots stream through RPC + CLI; explorers visualise the same baseline.</li>
</ul>
<p><strong>Economic + lane pricing parameters (defaults):</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Param</th><th>Default</th><th>Notes</th></tr></thead><tbody>
<tr><td><code>beta_storage_sub</code></td><td>50</td><td>Storage subsidy multiplier</td></tr>
<tr><td><code>gamma_read_sub</code></td><td>20</td><td>Read subsidy multiplier</td></tr>
<tr><td><code>kappa_cpu_sub</code></td><td>10</td><td>Compute subsidy multiplier</td></tr>
<tr><td><code>lambda_bytes_out_sub</code></td><td>5</td><td>Bandwidth subsidy multiplier</td></tr>
<tr><td><code>read_subsidy_viewer_percent</code></td><td>40</td><td>Read subsidy split</td></tr>
<tr><td><code>read_subsidy_host_percent</code></td><td>30</td><td>Read subsidy split</td></tr>
<tr><td><code>read_subsidy_hardware_percent</code></td><td>15</td><td>Read subsidy split</td></tr>
<tr><td><code>read_subsidy_verifier_percent</code></td><td>10</td><td>Read subsidy split</td></tr>
<tr><td><code>read_subsidy_liquidity_percent</code></td><td>5</td><td>Read subsidy split</td></tr>
<tr><td><code>treasury_percent</code></td><td>0</td><td>Treasury share of fees</td></tr>
<tr><td><code>proof_rebate_limit</code></td><td>1</td><td>Max proof rebate share</td></tr>
<tr><td><code>rent_rate_per_byte</code></td><td>0</td><td>Storage rent rate</td></tr>
<tr><td><code>lane_based_settlement_enabled</code></td><td>0</td><td>Enable lane-based settlement routing</td></tr>
<tr><td><code>lane_consumer_capacity</code></td><td>1000</td><td>Consumer capacity</td></tr>
<tr><td><code>lane_industrial_capacity</code></td><td>500</td><td>Industrial capacity</td></tr>
<tr><td><code>lane_consumer_congestion_sensitivity</code></td><td>300</td><td>k = 3.0</td></tr>
<tr><td><code>lane_industrial_congestion_sensitivity</code></td><td>500</td><td>k = 5.0</td></tr>
<tr><td><code>lane_industrial_min_premium_percent</code></td><td>50</td><td>Premium floor</td></tr>
<tr><td><code>lane_target_utilization_percent</code></td><td>70</td><td>PI target</td></tr>
<tr><td><code>lane_market_signal_half_life</code></td><td>50</td><td>EMA half-life (blocks)</td></tr>
<tr><td><code>lane_market_demand_max_multiplier_percent</code></td><td>300</td><td>Max demand multiplier</td></tr>
<tr><td><code>lane_market_demand_sensitivity_percent</code></td><td>200</td><td>Demand sensitivity</td></tr>
<tr><td><code>lane_pi_proportional_gain_percent</code></td><td>10</td><td>Kp = 0.1</td></tr>
<tr><td><code>lane_pi_integral_gain_percent</code></td><td>1</td><td>Ki = 0.01</td></tr>
</tbody></table>
</div>
<p>For the full parameter catalog (all governance knobs + defaults), see <code>docs/system_reference.md#appendix-e--governance-parameter-catalog-partial</code>, which should mirror the latest entries in <code>node/src/governance/params.rs</code>.</p>
<h2 id="commitreveal-and-pq-hooks"><a class="header" href="#commitreveal-and-pq-hooks">Commit–Reveal and PQ Hooks</a></h2>
<ul>
<li><code>node/src/commit_reveal.rs</code> implements Dilithium-based commits when compiled with <code>pq-crypto</code>, otherwise BLAKE3 commitments. Used for ballots, treasury releases, and challenge proofs.</li>
<li>Governance DAG nodes store both commit and reveal payloads plus telemetry for mismatches.</li>
</ul>
<h2 id="treasury-kill-switch-and-risk-controls"><a class="header" href="#treasury-kill-switch-and-risk-controls">Treasury Kill Switch and Risk Controls</a></h2>
<ul>
<li><code>governance/src/state.rs</code> wires <code>kill_switch_subsidy_reduction</code>, <code>kill_switch_fee_floor</code>, and range-boost toggles to treasury guardians.</li>
<li>Risk mitigations from the former <code>docs/risk_register.md</code>, <code>docs/audit_handbook.md</code>, and <code>docs/system_changes.md</code> live here plus <code>docs/security_and_privacy.md</code>.</li>
</ul>
<h2 id="settlement-and-audit-guarantees"><a class="header" href="#settlement-and-audit-guarantees">Settlement and Audit Guarantees</a></h2>
<ul>
<li><code>tools/settlement_audit</code> and <code>node/tests/settlement_audit.rs</code> reconcile receipts against ledger anchors. Operators must keep <code>cargo test -p the_block --test settlement_audit --release</code> green.</li>
<li>Settlement switch semantics (industrial vs consumer routing) live in <code>node/src/compute_market/settlement</code> and <code>node/src/storage/pipeline</code>. Governance toggles them via params documented here.</li>
</ul>
<h2 id="governance-tooling"><a class="header" href="#governance-tooling">Governance Tooling</a></h2>
<ul>
<li>CLI: <code>cli/src/gov.rs</code> now exposes the disbursement workflow end-to-end: <code>contract-cli gov disburse create|preview|submit|show|queue|execute|rollback</code> plus <code>--schema</code>/<code>--check</code> helpers for JSON payload validation. Existing proposal/DAG helpers remain alongside <code>cli/src/service_badge.rs</code> (badge status) and <code>cli/src/telemetry.rs</code> (wrapper metadata).</li>
<li>Explorer + log indexer share the same governance crate via <code>foundation_serialization</code> + <code>foundation_sqlite</code> wrappers.</li>
<li>Metrics aggregator publishes <code>/governance</code>, <code>/treasury</code>, <code>/wrappers</code>, and <code>/bridge</code> dashboards plus webhook outputs (<code>docs/operations.md#metrics-aggregator</code>).</li>
</ul>
<h2 id="ledger-invariants"><a class="header" href="#ledger-invariants">Ledger Invariants</a></h2>
<ul>
<li>Ledger invariants from the former <code>docs/ledger_invariants.md</code> now anchor here: no mint-to-EOA, subsidy buckets sum to the recorded total, governance history is monotonic, badge revocations are fully logged, and macro-block anchors must match the gossip replay harness.</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="architecture.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="operations.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="architecture.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="operations.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
